<app-header-page></app-header-page>

<p-toast></p-toast>

<div *ngIf="alertError" class="alert alert-danger mt-3 mb-0">
  {{ alertError }}
</div>

<div class="wrapper wrapper-content">
  <div class="row">
    <div class="col-lg-12">
      <div class="row">
        <div class="col-lg-12">
          <div class="ibox">
            <div
              style="min-height: 450px"
              class="ibox-content"
              id="gird-container"
            >
              <div class="d-flex justify-content-between mb-2">
                <h2>{{ titulo }}</h2>
              </div>
              <div [style]="{ width: '100%', height: '600px' }">
                <form
                  role="form"
                  [formGroup]="form"
                  (ngSubmit)="onSubmit()"
                  *ngIf="result$ | async as result"
                >
                  <input type="hidden" formControlName="id" />

                  <div class="col-sm-6">
                    <div class="form-group">
                      <label>Senha Atual</label>
                      <input
                        type="password"
                        required
                        class="form-control"
                        formControlName="senhaAtual"
                      />
                      <div class="invalid-feedback" *ngIf="invalid('senhaatual')">
                        <div *ngFor="let item of result.validators['senhaatual']">
                          {{ item.value }}
                        </div>
                      </div>
                    </div>

                    
                  </div>
                  <div class="col-sm-6">
                    <div class="form-group">
                      <label>Nova Senha </label>

                      <input
                        type="password"
                        required
                        class="form-control"
                        formControlName="senhaNova"
                        (ngModelChange)="modelChangeIcons($event)"
                      />
                      <div class="invalid-feedback" *ngIf="invalid('senhanova')">
                        <div *ngFor="let item of result.validators['senhanova']">
                          {{ item.value }}
                        </div>
                      </div>

                      <div class="mt-2" *ngIf="this.startAnimationIcons">
                        <div class="d-flex flex-column">
                          <label class="mb-2"><b>A senha deve conter:</b></label>

                          <label>
                            <span
                              class="fa fa-spinner fa-pulse fa-3x fa-fw mr-1"
                              *ngIf="!this.letraMaiuscula"
                            >
                            </span>
                            <span
                              class="fa fa-check-circle mr-1"
                              aria-hidden="true"
                              *ngIf="this.letraMaiuscula"
                            >
                            </span>Pelo menos 1 letra maiúscula.
                          </label>

                          <label>
                            <span
                              class="fa fa-spinner fa-pulse fa-3x fa-fw mr-1"
                              *ngIf="!this.letraMinuscula"
                            >
                            </span>
                            <span
                              class="fa fa-check-circle mr-1"
                              aria-hidden="true"
                              *ngIf="this.letraMinuscula"
                            >
                            </span>Pelo menos 1 letra minúscula.
                          </label>

                          <label>
                            <span
                              class="fa fa-spinner fa-pulse fa-3x fa-fw mr-1"
                              *ngIf="!this.digito"
                            >
                            </span>
                            <span
                              class="fa fa-check-circle mr-1"
                              aria-hidden="true"
                              *ngIf="this.digito"
                            >
                            </span>Pelo menos 1 número.
                          </label>

                          <label>
                            <span
                              class="fa fa-spinner fa-pulse fa-3x fa-fw mr-1"
                              *ngIf="!this.caractEspecial"
                            >
                            </span>
                            <span
                              class="fa fa-check-circle mr-1"
                              aria-hidden="true"
                              *ngIf="this.caractEspecial"
                            >
                            </span>Pelo menos 1 caractere especial (@#$%).
                          </label>

                          <label>
                            <span
                              class="fa fa-spinner fa-pulse fa-3x fa-fw mr-1"
                              *ngIf="!this.totalCaracteres"
                            >
                            </span>
                            <span
                              class="fa fa-check-circle mr-1"
                              aria-hidden="true"
                              *ngIf="this.totalCaracteres"
                            >
                            </span>No mínimo 6 caracteres.
                          </label>
                        </div>
                      </div>

                    </div>
                  </div>
                  <div class="col-sm-6">
                    <div class="form-group">
                      <label>Confirmar Senha </label>
                      <input
                        type="password"
                        required
                        class="form-control"
                        formControlName="senhaConfirmar"
                      />
                      <div class="invalid-feedback" *ngIf="invalid('senhaconfirmar')">
                        <div *ngFor="let item of result.validators['senhaconfirmar']">
                          {{ item.value }}
                        </div>
                      </div>
                    </div>
                    
                  </div>
                  <br />
                  <div class="col-sm-6">
                    <div class="d-flex">
                      <div>
                        <button
                          [disabled]="loading"
                          class="btn btn-primary float-right"
                          (click)="onSubmit()"
                        >
                          <span
                            *ngIf="loading"
                            class="spinner-border spinner-border-sm mr-1"
                          ></span>
                          <span *ngIf="!loading" class="fa fa-plus mr-1"></span>
                          Alterar Senha
                        </button>
                      </div>
                    </div>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
